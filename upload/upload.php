<?php
   if (isset($_POST["submit"])) {
      $difficulty = file_get_contents("../dif.dat");
      if (file_exists("../img/".$_FILES['fileToUpload']['name'])) {
         header("Location: ../error/?e=1");
         exit;
      }
      if ($_FILES["fileToUpload"]["size"] > 20000000) {
         header("Location: ../error/?e=2");
         exit;
      }

      if ($difficulty == "easy") {
         move_uploaded_file($_FILES['fileToUpload']['tmp_name'],'../img/'.$_FILES['fileToUpload']['name']);
         header("Location: ../done/?f=".$_FILES['fileToUpload']['name']);
         exit;
      }

      if ($difficulty == "medium") {
         if ($_FILES['fileToUpload']['type'] != "image/jpeg") {
            header("Location: ../error/?e=3");
            exit;
         } else {
            move_uploaded_file($_FILES['fileToUpload']['tmp_name'],'../img/'.$_FILES['fileToUpload']['name']);
            header("Location: ../done/?f=".$_FILES['fileToUpload']['name']);
            exit;
         }
      }

      if ($difficulty == "hard") {
         $ext = strtolower(substr($_FILES['fileToUpload']['name'], strrpos($_FILES['fileToUpload']['name'], ".") + 1));
         if ($ext != "png" && $ext != "jpg" && $ext != "jpeg" && $ext != "gif" && $ext != "webm") {
            header("Location: ../error/?e=3");
            exit;
         } else {
            move_uploaded_file($_FILES['fileToUpload']['tmp_name'],'../img/'.$_FILES['fileToUpload']['name']);
            header("Location: ../done/?f=".$_FILES['fileToUpload']['name']);
            exit;
         }
      }


   }
?>
